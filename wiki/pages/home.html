{% extends "layout-home.html" %}

{% block title %}Home{% endblock %}
{% block lead %}<b>Welcome to iGEM 2024!</b> Your team has been approved and you are ready to start the iGEM season!{%
endblock %}

{% block page_content %}
<!-- 主体部分 -->
<div class="container">
    <div id="loader-wrapper">
        <div id="loader">
            <div class="loader-img">
                <img src="https://static.igem.wiki/teams/5136/load.gif">
            </div>
        </div>
        <div class="loader-section section-left"></div>
        <div class="loader-section section-right"></div>
    </div>
    <!-- banner-page -->
    <div class="banner" id="hoverArea" style="cursor: pointer;">
        <div id="triangle"></div>
        <div class="bannerbox">
            <div class="bg1">
                <img src="https://static.igem.wiki/teams/5136/home/bannnerbg.png" alt=""
                    style="width: 100vw;height: 87vh;">
            </div>
            <div class="bg2">
                <img src="https://static.igem.wiki/teams/5136/home/dog.gif" alt="" style="width: 50vw;height: 60vh;">
            </div>
            <div class="logo">
                <img src="https://static.igem.wiki/teams/5136/home/witch.png" alt=""
                    style="height: 70vh;top: 25vh;position: absolute;z-index: 4;">
                <img src="https://static.igem.wiki/teams/5136/home/reparo.png" alt=""
                    style="top:60vh;position: absolute;left: 30vw;z-index: 4;height: 28vh;">
            </div>
        </div>
    </div>

    <!-- main content -->
    <div class="page">
        <div class="page-container">
            <div style="width: 40vw;position: relative;left: 10vw;top: 20vh;">
                <p>
                    The deteriorating climate crisis triggered by high <span class="emphasize">greenhouse gases
                        (GHG)</span> emissions has led to retreated Arctic ice sheets, rising sea levels, El Ninos and
                    many other climate disasters worldwide. According to statistics, <span class="emphasize">54
                        billion</span> tons of carbon dioxide are emitted globally every year, with a concentration
                    <span class="emphasize">50%</span> higher than in the pre-industrial era.
                </p>
            </div>
            <img src="https://static.igem.wiki/teams/5136/home/earth.png" alt=""
                style="width: 35vw;position: relative;top: -45vh;left: 55vw;" class="earth">
        </div>

        <div class="gas1" style="z-index: 51;">
            <img src="https://static.igem.wiki/teams/5136/home/co2.png" alt=""
                style="height: 10vh;position: relative;z-index: 51;left: 60%;" class="co2 gas-animation">
            <img src="https://static.igem.wiki/teams/5136/home/o2.png" alt=""
                style="height: 10vh;z-index: 52;position: relative;left: 10%;top: 30vh;" class="o2 gas-animation">
            <img src="https://static.igem.wiki/teams/5136/home/smoke.png" alt=""
                style="height: 25vh;position: relative;left: 22vw;z-index: 50;top: 5vh;" class="smoke gas-animation">
        </div>

        <div class="page-container">
            <img src="https://static.igem.wiki/teams/5136/home/tree1.png" alt="" id="slideforest"
                style="height: 70vh;position: relative;width: 50%;">
            <div style="position: relative;width: 40%;left: 55%;top: -50vh;">
                <p>
                    In this context, forests, known as the 'lungs of the earth', can provide critical support for
                    alleviating the climate crisis by converting carbon dioxide into oxygen through natural carbon
                    capture mechanisms.
                </p>
            </div>
        </div>

        <div class="page-container">
            <div style="width: 30%;position: relative;left: 10vw;top: 30vh;">
                <p>
                    However, nearly <span class="emphasize">13 million</span> hectares of forests are destroyed each
                    year as a result of human activity.
                </p>
            </div>
            <img src="https://static.igem.wiki/teams/5136/home/wood.png" alt=""
                style="position: relative;width: 50%;left: 40%;top: -10vh;">
            <div class="co2container">
                <img src="https://static.igem.wiki/teams/5136/home/co2.png" alt="" id="center-image">
            </div>
        </div>

        <div class="page-container">
            <img src="https://static.igem.wiki/teams/5136/home/papermaking.png" alt=""
                style="position: relative;top: 20vh;left: 10vw;width: 35vw;">
            <div style="position: relative;left: 50vw;width: 40vw;top: -40vh;">
                <p>
                    As a major application for forest resources, the paper industry has a constant demand for wood.
                    Paper, one of the Four Great Inventions of ancient China, acted as a carrier of knowledge and
                    information spread to the world through the Silk Road, increasing economic and cultural exchanges
                    among countries and promoting the progress of humans.
                </p>
            </div>
        </div>

        <div class="page-container">
            <div style="width: 45%;position: relative;left: 10vw;width: 40vw;top: 20vh;">
                <p>
                    Against the backdrop of economic globalization, the demand for paper in modern society has continued
                    to grow, leading to the cutting down of a large number of trees, disrupting the ecological balance
                    of nature and exacerbating the climate crisis.
                </p>
            </div>
            <img src="https://static.igem.wiki/teams/5136/home/paper.png" alt=""
                style="position: relative;left: 50vw;top: -30vh;width: 40vw;">
        </div>

        <div class="page-container">
            <img src="https://static.igem.wiki/teams/5136/home/circle.png" alt=""
                style="position: relative;left: 10vw;top: 10vh;width: 35vw;">
            <div style="position: relative;top: -40vh;left: 50vw;width: 40vw;">
                <p>
                    Fortunately, it is feasible to turn waste paper into fresh paper, which attracts our attention
                    gradually. Therefore, we hope to make contribution to reduce deforestation and ameliorate the
                    climate crisis by enhancing the cyclic utilization of paper.
                </p>
            </div>
        </div>

        <div class="page-container">
            <div style="position: relative;">
                <div style="position: absolute;width: 75vw;left: 2vw;text-align: center;top: 15vh;" class="tianping">
                    <h2
                        style="background: #6d5b93;color: white;font-size: 3vh;line-height: 5vh;border-radius: 10px;margin: auto;width: 50vw;margin-bottom: 5vh;padding: 15px;">
                        According to statistics, producing recycled paper by waste paper greatly benefits the earth.
                    </h2>
                    <p id="p1">
                        Reuse 1 ton of waste paper saves 17 <span style="color: #768163;">trees</span>
                    </p>
                    <p id="p2">
                        Reuse 1 ton of waste paper saves 100 tons of <span style="color: #5b6790;">water</span>
                    </p>
                    <p id="p3">
                        Reuse 1 ton of waste paper saves 600 kWh of <span style="color: #d5932d;">electricity</span>
                    </p>
                    <p id="p4">
                        Reuse 1 ton of waste paper saves 11.37 tons of <span style="color: #6e5e9c;">carbon
                            dioxide</span>.
                    </p>
                </div>
                <div class="tp">
                    <img src="https://static.igem.wiki/teams/5136/home/tianping1.png" alt=""
                        style="position: absolute;width: 27vw;left: 70vw;top: 15vh;">
                    <img src="https://static.igem.wiki/teams/5136/home/tp1.png" alt=""
                        style="width: 24vw;position: absolute;left: 72vw;top: 35vh;" id="tp-carousel">
                </div>
            </div>
        </div>

        <div class="page-container">
            <img src="https://static.igem.wiki/teams/5136/home/papertree.png" alt=""
                style="position: relative;top: 0;left: 10vw;width: 35vw;">
            <div style="position: relative;top: -40vh;left: 50vw;width: 40vw;">
                <p>
                    However, the difficulty and low utilization rate of the waste paper recycling process are serious
                    obstacles to the sustainable utilization of forest resources.
                </p>
            </div>
        </div>

        <div class="page-container">
            <div style="position: relative;left: 10vw;top: 10vh;width: 35vw;">
                <p>
                    Over the past decade, China's waste paper recycling rate has maintained at ~50%, while the
                    utilization rate of waste paper has decreased from 72.5% (2014) to 52.4% (2023).
                </p>
            </div>
            <img src="https://static.igem.wiki/teams/5136/home/data-bg.png" alt=""
                style="height: 60vh;position: relative;left: 45vw;width: 50vw;top: -35vh;">
            <div class="title" style="position: relative;width: 28vw;left: 52vw;top: -85vh;">
                <p style="font-size: 1.5vw;">
                    China's waste paper <span style="color: #6d5b93;">utilization rate</span> from 2014 to 2023
                </p>
                <div id="carousel" style="position: relative;top: 5vh;">72.5% in 2014</div>
            </div>
        </div>

        <div class="page-container">
            <img src="https://static.igem.wiki/teams/5136/home/factory.png" alt=""
                style="position: relative;left: 10vw;width: 40vw;">
            <div style="position: relative;left: 53vw;width: 40vw;top: -55vh;">
                <p>
                    In the paper industry, the recovery and reuse of waste paper mainly relies on a conventional
                    chemical-driven deinking technological process, which is the most intractable problem in the
                    recycling industry because it demands a substantial amount of chemicals, with serious impacts on the
                    environment and workers' health.
                </p>
            </div>
        </div>

        <div class="page-container">
            <div style="position: relative;top: 10vh;left: 10vw;width: 40vw;">
                <p>
                    With this in mind, we are committed to finding a more eco-friendly, economical and safe alternative
                    method. Our project focuses on tackling the challenges of high cost, environmental pollution and
                    health risks in the current deinking process. We also proposed a standard operating procedure (SOP)
                    for the synthetic biology-dominated deinking technological process: REPARO.
                </p>
            </div>
            <img src="https://static.igem.wiki/teams/5136/home/yuanli.png" alt=""
                style="position: relative;top: -55vh;left: 50vw;width: 45vw;">
        </div>

        <div class="page-container">
            <img src="https://static.igem.wiki/teams/5136/home/circulate.png" alt=""
                style="position: relative;left: 10vw;width: 35vw;top: 10vh;">
            <div style="position: relative;width: 40vw;left: 50vw;top: -50vh;">
                <p>
                    To ameliorate the climate crisis, our project focuses on investigating the current situation and
                    problems of waste paper recycling, providing an unprecedented answer to the bottleneck of recycle
                    utilization, and arousing broad public concern on resource recycling and climate crisis.
                </p>
            </div>
        </div>

        <div class="page-container" style="height: 100vh;">
            <div style="position: relative;top: 50vh;width: 50vw;left: 10vw;">
                <p>
                    Within the REPARO project, we will continue to optimize the paper deinking and wastewater
                    reprocessing technological process to propose future solutions for eliminating handwriting on
                    writing paper.
                </p>
            </div>
            <img src="https://static.igem.wiki/teams/5136/home/thinker.png" alt=""
                style="position: relative;top: -5vh;left: 60vw;width: 35vw;z-index: 6;">
            <div class="think-lunbo" style="position: relative;top: -85vh;z-index: 7;left: 25vw;">
                <img src="https://static.igem.wiki/teams/5136/home/thinker1.png" alt="" style="width: 40vw;"
                    id="slideshow">
            </div>
        </div>
    </div>
</div>

<!-- banner hover -->
<script>
    const text = 'XMU-China Promotion Video ';
    const textSize = 10;
    const textColor = 'black';
    const R = 50;
    const textSpeed = 0.005;

    const characters = text.split('');
    const L = characters.length;

    const myTextElements = [];
    for (let i = 0; i < L; i++) {
        const span = document.createElement('div');
        span.className = 'text';
        span.style.fontSize = `${textSize}pt`;
        span.style.color = textColor;
        span.innerText = characters[i];
        document.body.appendChild(span);
        myTextElements.push(span);
    }

    let xpos = 0;
    let ypos = 0;
    let setSpeed = 0;
    let spinning = false;

    function Spin() {
        for (let i = 0; i < myTextElements.length; i++) {
            const angle = setSpeed + (i * (360 / L) * Math.PI / 180);
            const x = xpos + R * Math.cos(angle);
            const y = ypos + R * Math.sin(angle);

            myTextElements[i].style.top = `${y}px`;
            myTextElements[i].style.left = `${x}px`;
            myTextElements[i].style.transform = `rotate(${angle + Math.PI / 2}rad)`;
        }
        setSpeed += textSpeed;
        if (spinning) requestAnimationFrame(Spin);
    }

    function Mouse(event) {
        xpos = event.clientX;
        ypos = event.clientY;

        // 更新三角形位置
        const triangle = document.getElementById('triangle');
        triangle.style.left = `${xpos}px`; // 三角形相对于鼠标位置偏移
        triangle.style.top = `${ypos}px`; // 三角形相对于鼠标位置偏移
    }

    const hoverArea = document.getElementById('hoverArea');
    hoverArea.addEventListener('mouseenter', () => {
        spinning = true;
        Spin();
    });
    hoverArea.addEventListener('mouseleave', () => {
        spinning = false;
    });
    hoverArea.addEventListener('mousemove', Mouse);

    hoverArea.addEventListener('click', () => {
        window.location.href = 'https://video.igem.org/videos/embed/5ff37219-b999-42de-9e26-d4ac301762b3'; // 替换为实际目标链接
    });
</script>

<!-- earth滚动 -->
<script>
    // 获取图片元素
    const image = document.querySelector('.earth');
    const co2 = document.querySelector('.co2');
    const o2 = document.querySelector('.o2');
    const smoke = document.querySelector('.smoke');
    //let hasActivated = false; // 防止动画重复激活
    // 监听滚动事件
    window.addEventListener('scroll', () => {
        // 获取图片的位置
        const imageRect = image.getBoundingClientRect();
        const windowHeight = window.innerHeight;

        // 图片开始进入视窗时的高度，和完全出现在视窗中的高度
        const imageTop = imageRect.top + 100;
        const imageBottom = imageRect.bottom;

        // 当图片的顶部出现在视窗内时开始旋转，底部到达视窗底部时旋转结束
        if (imageTop < windowHeight && imageBottom > 0) {
            // 计算图片出现在视窗中的比例 (0 到 1 之间)
            const progress = Math.min(1, Math.max(0, (windowHeight - imageTop) * 1.8 / (imageRect.height + windowHeight)));

            // 根据滚动进度计算旋转角度，最多旋转 180 度
            const rotation = progress * 180;

            // 应用旋转效果
            image.style.transform = `rotate(${rotation}deg)`;

            if (rotation >= 180) {
                // 激活气体动画
                co2.classList.add('active-co2');
                o2.classList.add('active-o2');
                smoke.classList.add('active-smoke');
                //hasActivated = true; // 确保动画只触发一次
            }
            else {
                //hasActivated = false;
                co2.classList.remove('active-co2');
                o2.classList.remove('active-o2');
                smoke.classList.remove('active-smoke');
            }
        }
    });
</script>

<!-- 森林摇摆 -->
<script>
    // 图片列表
    const images = [
        'https://static.igem.wiki/teams/5136/home/tree1.png',
        'https://static.igem.wiki/teams/5136/home/tree3.png',
        'https://static.igem.wiki/teams/5136/home/tree2.png',
        'https://static.igem.wiki/teams/5136/home/tree3.png',
    ];

    let currentIndex = 0; // 当前图片索引
    const imgElement = document.getElementById('slideforest');

    // 设置定时器，每隔3秒切换一次图片
    setInterval(() => {
        // 先执行淡出效果
        imgElement.classList.add('fade-out');

        // 等淡出动画完成后更改图片
        setTimeout(() => {
            currentIndex = (currentIndex + 1) % images.length; // 循环切换图片索引
            imgElement.src = images[currentIndex]; // 更新图片src

            // 图片更改后执行淡入效果
            imgElement.classList.remove('fade-out');
            imgElement.classList.add('fade-in');
        }, 20); // 淡出效果的时间与CSS中`transition`的时间一致
    }, 200); // 每隔4秒切换一次图片，留1秒给淡入淡出效果
</script>

<!-- co2增加 -->
<script>
    const container = document.querySelector('.co2container');
    const centerImage = document.getElementById('center-image');

    // 设置生成图片的数量和每次生成的间隔时间
    let numberOfImages = 10; // 总共生成10个图片
    let intervalTime = 1000; // 每隔500ms生成一个新图片

    const startAnimation = () => {
        let count = 0;
        const interval = setInterval(() => {
            if (count >= numberOfImages) {
                clearInterval(interval);
                return;
            }

            // 创建新的图片元素
            const newImage = document.createElement('img');
            newImage.src = centerImage.src;
            newImage.style.position = 'absolute';
            newImage.style.height = '8vh';
            newImage.style.top = '50%';
            newImage.style.left = '50%';
            newImage.style.transform = 'translate(-50%, -50%)';
            newImage.style.opacity = '0';

            // 动态生成图片的随机位置偏移
            const randomX = Math.floor(Math.random() * 800 - 600);
            const randomY = -Math.floor(Math.random() * 400 - 200);

            // 使用 CSS 变量传递偏移值
            newImage.style.setProperty('--x', `${randomX}px`);
            newImage.style.setProperty('--y', `${randomY}px`);

            // 添加动画类
            newImage.style.animation = 'expand 2s ease-out forwards';

            // 将新的图片元素添加到容器中
            container.appendChild(newImage);

            count++;
        }, intervalTime);
    };


    // 使用 Intersection Observer 观察图片容器是否进入视口
    const observer = new IntersectionObserver(entries => {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                // 当图片容器进入视口时触发动画
                startAnimation();
                // 停止观察，防止动画重复触发
                observer.unobserve(container);
            }
        });
    });

    // 开始观察容器元素
    observer.observe(container);
</script>



<!-- 天平图片轮播 -->
<script>
    // 定义一个包含图片路径的数组
    const imagestp = [
        "https://static.igem.wiki/teams/5136/home/tp1.png",
        "https://static.igem.wiki/teams/5136/home/tp2.png",
        "https://static.igem.wiki/teams/5136/home/tp3.png",
        "https://static.igem.wiki/teams/5136/home/tp4.png"
    ];

    // 获取第二个 img 元素
    const carouselImg = document.getElementById('tp-carousel');

    // 获取所有 p 标签
    const pElements = [
        document.getElementById('p1'),
        document.getElementById('p2'),
        document.getElementById('p3'),
        document.getElementById('p4')
    ];

    // 设置当前图片索引
    let currentImageIndex = 0;

    // 定义一个函数来切换图片
    function changeImage() {
        // 先让图片淡出
        carouselImg.style.opacity = 0;

        // 等待 500 毫秒后更新图片，并淡入
        setTimeout(() => {
            // 移除所有 p 标签的 active 类
            pElements.forEach(p => p.classList.remove('active'));

            currentImageIndex = (currentImageIndex + 1) % imagestp.length;
            carouselImg.src = imagestp[currentImageIndex];

            // 激活与当前图片对应的 p 标签
            pElements[currentImageIndex].classList.add('active');
            carouselImg.style.opacity = 1;
        }, 500); // 与 CSS 中的过渡时间匹配
    }


    // 启动定时器，每隔3秒切换一次图片
    setInterval(changeImage, 3000);

</script>

<!-- 数据轮播 -->
<script>
    const texts = [
        { value: "", year: 2014, percentage: 72.5 },
        { value: "", year: 2023, percentage: 52.4 },
        { value: "A decline of 20.1%", year: null, percentage: null }
    ];

    let dataIndex = 0;
    const displayTime = 1000; // 文本停留时间
    const transitionTime = 500; // 过渡时间
    let isAnimationStarted = false; // 控制动画是否已开始

    function updateText() {
        const carousel = document.getElementById('carousel');

        // 如果是第一幕，停留更长时间
        if (dataIndex === 0) {
            setTimeout(() => {
                startTransition();
            }, displayTime);
        } else {
            startTransition();
        }
    }

    function startTransition() {
        const carousel = document.getElementById('carousel');
        carousel.classList.add('fade-outt');

        setTimeout(() => {
            const { value } = texts[dataIndex];
            carousel.textContent = value;
            carousel.classList.remove('fade-outt');

            if (dataIndex === 0) {
                animateText(texts[dataIndex].percentage, texts[dataIndex + 1].percentage, texts[dataIndex].year, texts[dataIndex + 1].year);
            } else {
                dataIndex = (dataIndex + 1) % texts.length;
                setTimeout(updateText, displayTime); // 在新的文本上停留一定时间
            }
        }, transitionTime); // 等待过渡时间
    }

    function animateText(startPercentage, endPercentage, startYear, endYear) {
        const carousel = document.getElementById('carousel');

        let duration = 2000; // 动画持续时间
        let startTime = null;

        function animate(time) {
            if (!startTime) startTime = time;
            const elapsed = time - startTime;

            const progress = Math.min(elapsed / duration, 1);
            const currentPercentage = (startPercentage + (endPercentage - startPercentage) * progress).toFixed(1); // 保留一位小数
            const currentYear = startYear + (endYear - startYear) * progress;

            carousel.textContent = `${currentPercentage}% in ${Math.round(currentYear)}`;

            if (progress < 1) {
                requestAnimationFrame(animate);
            } else {
                setTimeout(() => {
                    dataIndex = (dataIndex + 1) % texts.length;
                    updateText(); // 更新到下一个文本
                }, displayTime);
            }
        }

        requestAnimationFrame(animate);
    }

    function handleIntersection(entries) {
        if (entries[0].isIntersecting && !isAnimationStarted) {
            isAnimationStarted = true;
            updateText(); // 启动动画
        }
    }

    // 创建观察者实例
    const observer1 = new IntersectionObserver(handleIntersection, { threshold: 0.1 });
    const carousel = document.getElementById('carousel');
    observer1.observe(carousel);
</script>

<!-- think轮播 -->
<script>
    const thinkimg = [
        'https://static.igem.wiki/teams/5136/home/thinker1.png',
        'https://static.igem.wiki/teams/5136/home/thinker2.png',
        'https://static.igem.wiki/teams/5136/home/thinker3.png'
    ];

    let thinkindex = 0;
    const slideshow = document.getElementById('slideshow');

    function showImage(index) {
        thinkindex = (index + thinkimg.length) % thinkimg.length; // 循环显示
        slideshow.style.opacity = 0; // Fade out
        setTimeout(() => {
            slideshow.src = thinkimg[thinkindex]; // 切换图片
            slideshow.style.opacity = 1; // Fade in
        }, 1000); // 与CSS过渡时间匹配
    }

    function startSlideshow() {
        setInterval(() => {
            showImage(thinkindex + 1);
        }, 3000); // 每3秒切换一次
    }

    document.addEventListener('DOMContentLoaded', startSlideshow);

</script>
{% endblock %}